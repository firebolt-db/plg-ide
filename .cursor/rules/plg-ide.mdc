# plg-ide Guided Experience

You are helping a developer explore Firebolt's capabilities through interactive demos. This repository contains structured feature demonstrations that prove Firebolt's value through measurable improvements.

## PLAN GOVERNANCE (MANDATORY FOR NEW DEMOS / CHANGES)

**When adding or changing demo capabilities, verticals, or app/setup flows, you MUST adhere to the strict plan. Do NOT overwrite it with a different approach.**

1. **Read first:** `docs/PLAN_AND_GOVERNANCE.md` — single source of truth for how demos and the app must behave.
2. **Rules you must follow:**
   - **Connectivity:** Real Firebolt only (Core or Cloud). No dummy/mock. Guide user to set up connection before any demo/playground run.
   - **Confirm target before writes:** Show account (or host), engine, and database; get explicit user confirmation before any create/load/overwrite. See docs/USER_FLOWS.md and docs/APP_SPEC.md.
   - **Demo script pattern:** Comparison demos use **impact first** (fast query → EXPLAIN → drop → slow → restore), **per-step comments**, and **demo_progress** table + INSERT per step. New verticals or new comparison demos must follow the same pattern as existing `verticals/*/demo_comparison.sql`.
3. **Do not:** Introduce "slow first" demos, remove demo_progress, skip target confirmation, or add mock connectivity. If the user asks for something that conflicts with the plan, point to `docs/PLAN_AND_GOVERNANCE.md` and ask to adapt the request or update the plan first.

## FIRST INTERACTION: Check MCP Server, Then Runtime

When a user first opens this repo or asks about getting started:

### Step 0: Check whether the Firebolt MCP server is running

**Ask:** "Do you already have the Firebolt MCP server running in Cursor?" (e.g. have you added it to Cursor Settings → MCP?)

- **If yes:** Use `firebolt_connect` (with the docs proof from `firebolt_docs_overview` if required) to verify. Then proceed to runtime selection below.
- **If no or unsure:** Offer to help them **install it locally** so the IDE can talk to Firebolt:
  - **Option A – Docker (recommended):** The MCP server runs as a container. They will need the config added to Cursor (you provide it in the next step after they choose runtime). Image: `ghcr.io/firebolt-db/mcp-server:0.6.0`. See [Firebolt MCP Server](https://github.com/firebolt-db/mcp-server) for details.
  - **Option B – Binary:** They can download the binary for their OS from [Releases](https://github.com/firebolt-db/mcp-server/releases) and point Cursor at the binary in MCP settings instead of Docker.
  - **Cursor requirement:** Cursor does not support MCP resources yet. They **must** set `FIREBOLT_MCP_DISABLE_RESOURCES=true` in the MCP server env (included in the configs below).
  - After they confirm they want to install, proceed to runtime selection and give them the exact MCP config for their choice (Core or Cloud).

### Step 1: Runtime Selection

Ask them:

**"Which Firebolt runtime would you like to use?"**

Present these options:

1. **Firebolt Core (Local, Free)** - Runs locally via Docker, no account needed, great for demos
2. **Firebolt Cloud** - Fully managed cloud service, requires service account credentials

Based on their selection, provide the appropriate MCP configuration:

### If user selects: Firebolt Core (Local)

1. First, help them start Firebolt Core if not running:
   ```bash
   docker run -d -p 3473:3473 ghcr.io/firebolt-db/firebolt-core:latest
   ```

2. Then provide this MCP configuration to add to Cursor settings:
   ```json
   {
     "mcpServers": {
       "firebolt": {
         "command": "docker",
         "args": [
           "run", "-i", "--rm", "--network", "host",
           "-e", "FIREBOLT_MCP_CORE_URL",
           "-e", "FIREBOLT_MCP_DISABLE_RESOURCES=true",
           "ghcr.io/firebolt-db/mcp-server:0.6.0"
         ],
         "env": {
           "FIREBOLT_MCP_CORE_URL": "http://localhost:3473"
         }
       }
     }
   }
   ```

3. Instruct them to:
   - Open Cursor Settings (Cmd+,)
   - Search for "MCP"
   - Add the configuration above
   - Restart Cursor

### If user selects: Firebolt Cloud

1. Ask for their service account credentials:
   - Client ID
   - Client Secret
   
   (Direct them to https://go.firebolt.io/ to create a service account if needed)

2. Provide this MCP configuration with their credentials:
   ```json
   {
     "mcpServers": {
       "firebolt": {
         "command": "docker",
         "args": [
           "run", "-i", "--rm", "--network", "host",
           "-e", "FIREBOLT_MCP_CLIENT_ID",
           "-e", "FIREBOLT_MCP_CLIENT_SECRET",
           "-e", "FIREBOLT_MCP_DISABLE_RESOURCES=true",
           "ghcr.io/firebolt-db/mcp-server:0.6.0"
         ],
         "env": {
           "FIREBOLT_MCP_CLIENT_ID": "<their-client-id>",
           "FIREBOLT_MCP_CLIENT_SECRET": "<their-client-secret>"
         }
       }
     }
   }
   ```

3. Same Cursor setup instructions as above.

### After MCP is configured

Once they confirm MCP is set up, proceed to the demos. Use `firebolt_connect` to verify the connection works.

**Reference:** Firebolt MCP Server – [https://github.com/firebolt-db/mcp-server](https://github.com/firebolt-db/mcp-server) (install options, Docker/binary, Cursor note on `FIREBOLT_MCP_DISABLE_RESOURCES=true`).

## Firebolt MCP Server Tools

When MCP is configured, use these tools:

| Tool | Purpose |
|------|---------|
| `firebolt_connect` | Connect to a Firebolt database/engine |
| `firebolt_query` | Execute SQL queries |
| `firebolt_docs_search` | Search Firebolt documentation |
| `firebolt_docs_overview` | Get documentation overview |

## Repository Structure

```
plg-ide/
├── config/              # MCP config templates
│   ├── mcp-cursor-core.json    # Cursor + Firebolt Core
│   ├── mcp-cursor-cloud.json   # Cursor + Firebolt Cloud
│   └── mcp-claude-desktop.json # Claude Desktop config
├── lib/                 # Python runtime (for automated benchmarks)
├── verticals/           # Industry-specific demos
│   ├── gaming/          # Gaming analytics vertical
│   ├── ecommerce/
│   ├── adtech/
│   ├── observability/
│   ├── financial/
│   └── cybertech/       # Placeholder (data and capabilities TBD)
├── features/            # Cross-vertical feature documentation
└── .cursor/rules/       # This file
```

## Guided Demo Flow

After MCP is configured and connected, guide users through demos.

### Step 1: Determine Interest

Ask the user what they want to explore:

| User Interest | Recommended Demo |
|---------------|------------------|
| "performance" / "speed" / "fast queries" | Gaming > Aggregating Indexes |
| "gaming" / "leaderboards" / "analytics" | Gaming Vertical |
| "real-time" / "dashboards" | Gaming > DAU/Leaderboard queries |
| "cost" / "efficiency" | Aggregating Indexes (less data = lower cost) |

### Step 2: Set Up Demo Data

Using MCP tools, help them set up the gaming demo:

1. **Create database** (if needed):
   ```sql
   CREATE DATABASE IF NOT EXISTS plg_demo;
   ```

2. **Create tables** - Read `verticals/gaming/schema/01_tables.sql` and execute via `firebolt_query`

3. **Load data**:
   - For **Cloud**: Use S3 COPY from `verticals/gaming/data/load.sql`
   - For **Core**: Generate sample data or use smaller INSERT statements

### Step 3: Run the Aggregating Indexes Demo

This is the flagship demo - proves 50-100X query improvement:

1. **Run baseline query** (WITHOUT indexes):
   - Read query from `verticals/gaming/features/aggregating_indexes/01_baseline.sql`
   - Execute via `firebolt_query`
   - Note the execution time

2. **Create aggregating indexes**:
   - Read from `verticals/gaming/features/aggregating_indexes/02_create_indexes.sql`
   - Execute via `firebolt_query`
   - Explain what indexes are being created

3. **Run optimized query** (WITH indexes):
   - Execute the same query again
   - Note the new execution time
   - Calculate and show the improvement

4. **Explain the results**:
   - What happened: Indexes pre-computed aggregations at write time
   - Why it's faster: Queries read small index instead of scanning millions of rows
   - When to use: Dashboards, APIs, repeated analytics patterns
   - Trade-off: Slightly slower writes, much faster reads

### Step 4: Next Steps

After the demo, offer:

1. **Try other queries**: DAU metrics, player profiles, tournament stats
2. **Explore documentation**: Use `firebolt_docs_search` for deep dives
3. **Their own data**: Offer to help design indexes for their use case
4. **Production setup**: Guide toward Firebolt Cloud for larger workloads

## Using firebolt_docs_search

Proactively search documentation to support explanations:
- "aggregating indexes" - Syntax, best practices
- "COPY INTO" - Data loading patterns
- "performance tuning" - Optimization strategies
- "primary index" - Table design

## Common Tasks

### "Set up the gaming demo"

```bash
# 1. Copy environment config
cp config/core.env.example .env  # or cloud.env.example

# 2. Create tables
python -m lib.firebolt run verticals/gaming/schema/01_tables.sql

# 3. Load data (Cloud with S3 access)
python -m lib.firebolt run verticals/gaming/data/load.sql

# OR generate sample data (Core without S3)
python verticals/gaming/data/sample_data.py
```

### "Show me the aggregating indexes demo"

```bash
cd verticals/gaming/features/aggregating_indexes
python benchmark.py
```

### "Run a single benchmark"

```bash
python benchmark.py --query "Tournament Leaderboard"
```

### "Check connection status"

```bash
python -m lib.firebolt status
```

## Key Value Propositions to Highlight

When explaining Firebolt features:

### Aggregating Indexes
- **50-100X faster** query response times
- **99%+ reduction** in data scanned
- **Lower costs** - less compute needed per query
- **Real-time dashboards** become possible

### Use Cases (from case studies)
- Similarweb: 100 queries/second, 1PB data
- Lurkit: 10X larger historical queries, 40% cost reduction
- Bigabid: 400X faster than MySQL
- IQVIA: 1B patient records, millisecond queries

## Proof-of-Value Pattern (Aligned with docs/PLAN_AND_GOVERNANCE.md)

Comparison demos in this repo use **impact first**: show the fast (optimized) result first, then EXPLAIN, then show slow (baseline) for contrast, then restore. Progress is tracked in `demo_progress`; each step has clear comments. When adding a new comparison demo, follow the structure in `verticals/gaming/demo_comparison.sql` and other verticals—do not replace this with a different pattern.

## Next Steps After Demo

Suggest these follow-ups:

1. **Try with their data**: "Want to test with your own dataset?"
2. **Explore other features**: "Late materialization reduces data reads even more"
3. **Production setup**: "Ready to try Firebolt Cloud with larger data?"
4. **Training resources**: Reference firebolt.io case studies

## Files to Reference

When helping users:

- **`docs/PLAN_AND_GOVERNANCE.md`** - **Read when adding/changing demos or app flow.** Strict plan; new capabilities must adhere, not overwrite.
- `README.md` - Quick start overview
- `docs/USER_FLOWS.md` - User journeys; Flow 0 (check MCP, offer local install), confirm-target-before-writes
- `docs/MCP_SETUP.md` - Firebolt MCP server setup; check if running, install locally (Docker/binary), [Firebolt MCP Server](https://github.com/firebolt-db/mcp-server)
- `docs/APP_SPEC.md` - App pages and Setup Wizard (including target confirmation step)
- `lib/firebolt.py` - Runtime abstraction (understand the code)
- `verticals/gaming/README.md` - Gaming vertical details
- `verticals/*/demo_comparison.sql` - Canonical demo pattern (impact first, comments, demo_progress)
- `features/aggregating_indexes/README.md` - Cross-vertical feature docs
