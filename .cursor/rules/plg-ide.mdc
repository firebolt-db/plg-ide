# plg-ide Guided Experience

You are helping a developer explore Firebolt's capabilities through interactive demos. This repository contains structured feature demonstrations that prove Firebolt's value through measurable improvements.

## PLAN GOVERNANCE (MANDATORY FOR NEW DEMOS / CHANGES)

**When adding or changing demo capabilities, verticals, or app/setup flows, you MUST adhere to the strict plan. Do NOT overwrite it with a different approach.**

1. **Read first:** `docs/PLAN_AND_GOVERNANCE.md` — single source of truth for how demos and the app must behave.
2. **Rules you must follow:**
   - **Connectivity:** Real Firebolt only (Core or Cloud). No dummy/mock. Guide user to set up connection before any demo/playground run.
   - **Confirm target before writes:** Show account (or host), engine, and database; get explicit user confirmation before any create/load/overwrite. See docs/USER_FLOWS.md and docs/APP_SPEC.md.
   - **Demo script pattern:** Comparison demos use **impact first** (fast query → EXPLAIN → drop → slow → restore), **per-step comments**, and **demo_progress** table + INSERT per step. New verticals or new comparison demos must follow the same pattern as existing `verticals/*/demo_comparison.sql`.
3. **Do not:** Introduce "slow first" demos, remove demo_progress, skip target confirmation, or add mock connectivity. If the user asks for something that conflicts with the plan, point to `docs/PLAN_AND_GOVERNANCE.md` and ask to adapt the request or update the plan first.

## FIRST INTERACTION: Check MCP Server, Then Runtime

When a user first opens this repo or asks about getting started:

### Step 0: Check whether the Firebolt MCP server is running

**Ask:** "Do you already have the Firebolt MCP server running in Cursor?" (e.g. have you added it to Cursor Settings → MCP?)

- **If yes:** Use `firebolt_connect` (with the docs proof from `firebolt_docs_overview` if required) to verify. Then proceed to runtime selection below.
- **If no or unsure:** Offer to help them **install it locally** so the IDE can talk to Firebolt:
  - **Option A – Docker (recommended):** The MCP server runs as a container. They will need the config added to Cursor (you provide it in the next step after they choose runtime). Image: `ghcr.io/firebolt-db/mcp-server:0.6.0`. See [Firebolt MCP Server](https://github.com/firebolt-db/mcp-server) for details.
  - **Option B – Binary:** They can download the binary for their OS from [Releases](https://github.com/firebolt-db/mcp-server/releases) and point Cursor at the binary in MCP settings instead of Docker.
  - **Cursor requirement:** Cursor does not support MCP resources yet. They **must** set `FIREBOLT_MCP_DISABLE_RESOURCES=true` in the MCP server env (included in the configs below).
  - After they confirm they want to install, proceed to runtime selection and give them the exact MCP config for their choice (Core or Cloud).

### Step 1: Runtime Selection

Ask them:

**"Which Firebolt runtime would you like to use?"**

Present these options:

1. **Firebolt Core (Local, Free)** - Runs locally via Docker, no account needed, great for demos
2. **Firebolt Cloud** - Fully managed cloud service, requires service account credentials

Based on their selection, provide the appropriate MCP configuration:

### If user selects: Firebolt Core (Local)

1. First, help them start Firebolt Core if not running:
   ```bash
   docker run -d -p 3473:3473 ghcr.io/firebolt-db/firebolt-core:latest
   ```

2. Then provide this MCP configuration to add to Cursor settings:
   ```json
   {
     "mcpServers": {
       "firebolt": {
         "command": "docker",
         "args": [
           "run", "-i", "--rm", "--network", "host",
           "-e", "FIREBOLT_MCP_CORE_URL",
           "-e", "FIREBOLT_MCP_DISABLE_RESOURCES=true",
           "ghcr.io/firebolt-db/mcp-server:0.6.0"
         ],
         "env": {
           "FIREBOLT_MCP_CORE_URL": "http://localhost:3473"
         }
       }
     }
   }
   ```

3. Instruct them to:
   - Open Cursor Settings (Cmd+,)
   - Search for "MCP"
   - Add the configuration above
   - Restart Cursor

### If user selects: Firebolt Cloud

1. Ask for their service account credentials:
   - Client ID
   - Client Secret
   
   (Direct them to https://go.firebolt.io/ to create a service account if needed)

2. Provide this MCP configuration with their credentials:
   ```json
   {
     "mcpServers": {
       "firebolt": {
         "command": "docker",
         "args": [
           "run", "-i", "--rm", "--network", "host",
           "-e", "FIREBOLT_MCP_CLIENT_ID",
           "-e", "FIREBOLT_MCP_CLIENT_SECRET",
           "-e", "FIREBOLT_MCP_DISABLE_RESOURCES=true",
           "ghcr.io/firebolt-db/mcp-server:0.6.0"
         ],
         "env": {
           "FIREBOLT_MCP_CLIENT_ID": "<their-client-id>",
           "FIREBOLT_MCP_CLIENT_SECRET": "<their-client-secret>"
         }
       }
     }
   }
   ```

3. Same Cursor setup instructions as above.

### After MCP is configured

Once they confirm MCP is set up, proceed to the demos. Use `firebolt_connect` to verify the connection works.

**Reference:** Firebolt MCP Server – [https://github.com/firebolt-db/mcp-server](https://github.com/firebolt-db/mcp-server) (install options, Docker/binary, Cursor note on `FIREBOLT_MCP_DISABLE_RESOURCES=true`).

## Firebolt MCP Server Tools

When MCP is configured, use these tools:

| Tool | Purpose |
|------|---------|
| `firebolt_connect` | Connect to a Firebolt database/engine |
| `firebolt_query` | Execute SQL queries |
| `firebolt_docs_search` | Search Firebolt documentation |
| `firebolt_docs_overview` | Get documentation overview |

## Repository Structure

```
plg-ide/
├── config/              # MCP config templates
│   ├── mcp-cursor-core.json    # Cursor + Firebolt Core
│   ├── mcp-cursor-cloud.json   # Cursor + Firebolt Cloud
│   └── mcp-claude-desktop.json # Claude Desktop config
├── lib/                 # Python runtime (for automated benchmarks)
├── verticals/           # Industry-specific demos
│   ├── gaming/          # Gaming analytics vertical
│   ├── ecommerce/
│   ├── adtech/
│   ├── observability/
│   ├── financial/
│   └── cybertech/       # Placeholder (data and capabilities TBD)
├── features/            # Cross-vertical feature documentation
└── .cursor/rules/       # This file
```

## Vertical and Feature List (Single Source of Truth)

**The list of verticals and their features comes from `docs/app-manifest.json`.** Read that file to discover available verticals and, for each vertical, the list of features (with `status`: `available` or `coming_soon`). Features may include `cloudOnly: true` or `availableRuntimes: ["cloud"]`—when the user is on **Firebolt Core**, do not run those demos; show SQL as reference and a "Cloud only" notice (see Step 3 below). Resolve all paths using the vertical and feature **ids** from the manifest:

- Vertical schema: `verticals/{vertical_id}/schema/01_tables.sql`
- Vertical data load: `verticals/{vertical_id}/data/load.sql` (Cloud/S3) or `verticals/{vertical_id}/data/sample_data.py` (Core)
- Feature demo SQL: `verticals/{vertical_id}/features/{feature_id}/01_baseline.sql`, `02_create_indexes.sql` (or `02_*.sql`), `verticals/{vertical_id}/features/{feature_id}/03_optimized.sql`
- Comparison script: `verticals/{vertical_id}/demo_comparison.sql`

If the user does not know which vertical or feature to pick, **suggest Gaming first** (id `gaming`) and Aggregating Indexes (id `aggregating_indexes`) as the default demo.

## Guided Demo Flow

After MCP is configured and connected, guide users through demos.

### Step 1: Choose Vertical (and Feature)

1. **Read `docs/app-manifest.json`** to get the list of verticals (each with `id`, `name`, `description`, `features[]`).
2. **Ask the user which vertical they want to explore** (e.g. Gaming, E-commerce, AdTech, Observability, Financial, CyberTech). Offer the list from the manifest; if they are unsure, suggest **Gaming** first.
3. **For the chosen vertical, ask which feature** they want (from that vertical's `features` in the manifest). Only run demos for features with `status: "available"`. If they pick a feature with `status: "coming_soon"`, say the demo is not yet available and suggest an available feature (e.g. Aggregating Indexes). **If the user says they only want to see one specific feature** (e.g. "I only want to see automated column statistics"), skip asking for vertical first: use the manifest to find a vertical that has that feature with `status: "available"` (e.g. Gaming for `automated_column_statistics`) and go straight to that feature's setup and demo steps.
4. **Resolve paths** using the vertical `id` and feature `id`: e.g. `verticals/gaming/...`, `verticals/ecommerce/features/partitioning/...`.

### Step 2: Set Up Demo Data

Using MCP tools, help them set up the chosen vertical's demo:

1. **Create database** (if needed):
   ```sql
   CREATE DATABASE IF NOT EXISTS plg_demo;
   ```

2. **Create tables** – Read `verticals/{vertical_id}/schema/01_tables.sql` and execute via `firebolt_query`.

3. **Load data**:
   - For **Cloud**: Use S3 COPY from `verticals/{vertical_id}/data/load.sql`
   - For **Core**: Use `verticals/{vertical_id}/data/sample_data.py` if present, or smaller INSERT statements

### Step 3: Run the Feature Demo

**Runtime check (Cloud-only features):** Before running any demo, check the feature in `docs/app-manifest.json` for `cloudOnly: true` or `availableRuntimes: ["cloud"]`. If the user is connected to **Firebolt Core** and the feature is Cloud-only (e.g. `engine_lifecycle`, `cross_region`):

- **Do not execute** the demo SQL via `firebolt_query`.
- **Show the SQL** from `01_baseline.sql`, `02_*.sql`, and `03_optimized.sql` as **reference examples** (read-only).
- **Display this notice:** "This capability is available in Firebolt Cloud. The examples above are for reference; switch to Cloud to run this demo." Optionally link to [Firebolt Cloud](https://www.firebolt.io/) or docs/DEEP_CONTROL.md.

If the user is on **Firebolt Cloud** or the feature is not Cloud-only, proceed with the steps below.

For the chosen vertical and feature (e.g. aggregating_indexes, partitioning):

1. **Run baseline** (without the feature): Read `verticals/{vertical_id}/features/{feature_id}/01_baseline.sql`, execute via `firebolt_query`, note execution time.
2. **Create or enable the feature**: If the feature has a `02_create_indexes.sql` or `02_*.sql`, read and execute it via `firebolt_query`; explain what is being created.
3. **Run optimized** (with the feature): Read `verticals/{vertical_id}/features/{feature_id}/03_optimized.sql`, execute via `firebolt_query`, note execution time.
4. **Show the comparison** (time, rows scanned, bytes read if available) and calculate improvement.

### Step 4: Explain Results and Why It's Differentiating

After running the demo:

1. **Explain the results**: What the feature does, why the query is faster, when to use it, trade-offs.
2. **Use MCP to explain why it's differentiating**: Call `firebolt_docs_search` (e.g. search for the feature name or "Firebolt vs" / "performance") and briefly summarize why this capability is differentiating compared to other data warehouses or engines. Keep it to one or two sentences unless the user asks for more.

### Step 5: Next Steps

After the demo, offer:

1. **Try other queries**: DAU metrics, player profiles, tournament stats
2. **Explore documentation**: Use `firebolt_docs_search` for deep dives
3. **Their own data**: Offer to help design indexes for their use case
4. **Production setup**: Guide toward Firebolt Cloud for larger workloads

## Using firebolt_docs_search

Proactively search documentation to support explanations:
- "aggregating indexes" - Syntax, best practices
- "COPY INTO" - Data loading patterns
- "performance tuning" - Optimization strategies
- "primary index" - Table design

## Common Tasks

Use `docs/app-manifest.json` to get vertical and feature ids; paths are `verticals/{vertical_id}/...` and `verticals/{vertical_id}/features/{feature_id}/...`. Example with Gaming:

### "Set up the gaming demo" (or any vertical)

```bash
# 1. Copy environment config
cp config/core.env.example .env  # or cloud.env.example

# 2. Create tables (replace gaming with chosen vertical_id)
python -m lib.firebolt run verticals/gaming/schema/01_tables.sql

# 3. Load data (Cloud with S3 access)
python -m lib.firebolt run verticals/gaming/data/load.sql

# OR generate sample data (Core without S3)
python verticals/gaming/data/sample_data.py
```

### "Show me the aggregating indexes demo" (or any feature)

```bash
cd verticals/gaming/features/aggregating_indexes
python benchmark.py
```

### "Run a single benchmark"

```bash
python benchmark.py --query "Tournament Leaderboard"
```

### "Check connection status"

```bash
python -m lib.firebolt status
```

## Key Value Propositions to Highlight

When explaining Firebolt features:

### Aggregating Indexes
- **50-100X faster** query response times
- **99%+ reduction** in data scanned
- **Lower costs** - less compute needed per query
- **Real-time dashboards** become possible

### Use Cases (from case studies)
- Similarweb: 100 queries/second, 1PB data
- Lurkit: 10X larger historical queries, 40% cost reduction
- Bigabid: 400X faster than MySQL
- IQVIA: 1B patient records, millisecond queries

## Proof-of-Value Pattern (Aligned with docs/PLAN_AND_GOVERNANCE.md)

Comparison demos in this repo use **impact first**: show the fast (optimized) result first, then EXPLAIN, then show slow (baseline) for contrast, then restore. Progress is tracked in `demo_progress`; each step has clear comments. When adding a new comparison demo, follow the structure in `verticals/gaming/demo_comparison.sql` and other verticals—do not replace this with a different pattern.

## Next Steps After Demo

Suggest these follow-ups:

1. **Try with their data**: "Want to test with your own dataset?"
2. **Explore other features**: "Late materialization reduces data reads even more"
3. **Production setup**: "Ready to try Firebolt Cloud with larger data?"
4. **Training resources**: Reference firebolt.io case studies

## Files to Reference

When helping users:

- **`docs/PLAN_AND_GOVERNANCE.md`** - **Read when adding/changing demos or app flow.** Strict plan; new capabilities must adhere, not overwrite.
- `README.md` - Quick start overview
- `docs/USER_FLOWS.md` - User journeys; Flow 0 (check MCP, offer local install), confirm-target-before-writes
- `docs/MCP_SETUP.md` - Firebolt MCP server setup; check if running, install locally (Docker/binary), [Firebolt MCP Server](https://github.com/firebolt-db/mcp-server)
- `docs/APP_SPEC.md` - App pages and Setup Wizard (including target confirmation step)
- `lib/firebolt.py` - Runtime abstraction (understand the code)
- **`docs/app-manifest.json`** - **Single source of truth for verticals and features.** Use this to list verticals and their features; resolve paths as `verticals/{vertical_id}/...` and `verticals/{vertical_id}/features/{feature_id}/...`.
- `verticals/{vertical_id}/README.md` - Vertical details (e.g. verticals/gaming/README.md)
- `verticals/*/demo_comparison.sql` - Canonical demo pattern (impact first, comments, demo_progress)
- `features/aggregating_indexes/README.md` - Cross-vertical feature docs
